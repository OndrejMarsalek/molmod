
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basic classes &mdash; MolMod 1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MolMod 1.1 documentation" href="../index.html" />
    <link rel="next" title="Input/output" href="io.html" />
    <link rel="prev" title="Units and constants" href="const.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="io.html" title="Input/output"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="const.html" title="Units and constants"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">MolMod 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="basic-classes">
<h1>Basic classes<a class="headerlink" href="#basic-classes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="molmod-molecules-molecular-systems">
<h2><a class="reference internal" href="#module-molmod.molecules" title="molmod.molecules"><tt class="xref py py-mod docutils literal"><span class="pre">molmod.molecules</span></tt></a> &#8211; Molecular systems<a class="headerlink" href="#molmod-molecules-molecular-systems" title="Permalink to this headline">¶</a></h2>
<p>Although the name of the class <tt class="xref py py-class docutils literal"><span class="pre">Molecule</span></tt> is singular, it is equally
suitable for a cluster or complex with multiple molecules, or even a complete
unit cell of a periodic system.</p>
<span class="target" id="module-molmod.molecules"></span><dl class="class">
<dt id="molmod.molecules.Molecule">
<em class="property">class </em><tt class="descclassname">molmod.molecules.</tt><tt class="descname">Molecule</tt><big>(</big><em>numbers</em>, <em>coordinates=None</em>, <em>title=None</em>, <em>masses=None</em>, <em>graph=None</em>, <em>symbols=None</em>, <em>unit_cell=None</em><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Extensible class for molecular systems.</p>
<p>Most attributes of the molecule object are treated as constants. If you
want to modify the molecular geometry, just create a modified molecule
object with the method <a class="reference internal" href="internals.html#molmod.utils.ReadOnly.copy_with" title="molmod.utils.ReadOnly.copy_with"><tt class="xref py py-meth docutils literal"><span class="pre">molmod.utils.ReadOnly.copy_with()</span></tt></a>. This facilitates the caching of
derived quantities such as the distance matrix, while it imposes a
cleaner coding style without a signifacant computational overhead.</p>
<dl class="docutils">
<dt>Mandatory arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">numbers</span></tt>  &#8211;  numpy array (1D, N elements) with the atomic numbers</div>
</div>
</dd>
<dt>Optional keyword arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">coordinates</span></tt>  &#8211;  numpy array (2D, Nx3 elements) Cartesian coordinates</div>
<div class="line"><tt class="docutils literal"><span class="pre">title</span></tt>  &#8211;  a string with the name of the molecule</div>
<div class="line"><tt class="docutils literal"><span class="pre">massess</span></tt>  &#8211;  a numpy array with atomic masses in atomic units</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  a MolecularGraph instance</div>
<div class="line"><tt class="docutils literal"><span class="pre">symbols</span></tt>  &#8211;  atomic elements or force-field atom-types</div>
<div class="line"><tt class="docutils literal"><span class="pre">unit_cell</span></tt>  &#8211;  the unit cell in case the system is periodic</div>
</div>
</dd>
</dl>
<dl class="attribute">
<dt id="molmod.molecules.Molecule.chemical_formula">
<tt class="descname">chemical_formula</tt><a class="headerlink" href="#molmod.molecules.Molecule.chemical_formula" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> the chemical formula of the molecule.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.com">
<tt class="descname">com</tt><a class="headerlink" href="#molmod.molecules.Molecule.com" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> the center of mass of the molecule.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.molecules.Molecule.compute_rotsym">
<tt class="descname">compute_rotsym</tt><big>(</big><em>threshold=0.0018897261339212521</em><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.compute_rotsym" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the rotational symmetry number.</p>
<dl class="docutils">
<dt>Optional argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">threshold</span></tt>  &#8211;  only when a rotation results in an rmsd below the given
threshold, the rotation is considered to transform the
molecule onto itself.</div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#molmod.molecules.Molecule.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> atomic Cartesian coordinates.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 2.</li>
<li>Must have shape (?, 3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
<li>Special conditions: the number of rows must be the same as the length of the array numbers.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.distance_matrix">
<tt class="descname">distance_matrix</tt><a class="headerlink" href="#molmod.molecules.Molecule.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> the matrix with all atom pair distances.</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.molecules.Molecule.from_file">
<em class="property">classmethod </em><tt class="descname">from_file</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a molecule object read from the given file.</p>
<p>The file format is inferred from the extensions. Currently supported
formats are: <tt class="docutils literal"><span class="pre">*.cml</span></tt>, <tt class="docutils literal"><span class="pre">*.fchk</span></tt>, <tt class="docutils literal"><span class="pre">*.pdb</span></tt>, <tt class="docutils literal"><span class="pre">*.sdf</span></tt>, <tt class="docutils literal"><span class="pre">*.xyz</span></tt></p>
<p>If a file contains more than one molecule, only the first one is
read.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">filename</span></tt>  &#8211;  the name of the file containing the molecule</div>
</div>
</dd>
</dl>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;foo.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.graph">
<tt class="descname">graph</tt><a class="headerlink" href="#molmod.molecules.Molecule.graph" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the molecular graph with the atom connectivity.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;class</span> <span class="pre">'molmod.molecular_graphs.MolecularGraph'&gt;</span></tt></li>
<li>Special conditions: the atomic numbers must match.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.inertia_tensor">
<tt class="descname">inertia_tensor</tt><a class="headerlink" href="#molmod.molecules.Molecule.inertia_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> the intertia tensor of the molecule.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.mass">
<tt class="descname">mass</tt><a class="headerlink" href="#molmod.molecules.Molecule.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> the total mass of the molecule.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.masses">
<tt class="descname">masses</tt><a class="headerlink" href="#molmod.molecules.Molecule.masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the atomic masses.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
<li>Special conditions: the size must be the same as the length of the array numbers.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.numbers">
<tt class="descname">numbers</tt><a class="headerlink" href="#molmod.molecules.Molecule.numbers" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the atomic numbers.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'int'&gt;</span></tt>.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="molmod.molecules.Molecule.rmsd">
<tt class="descname">rmsd</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the RMSD between two molecules.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">other</span></tt>  &#8211;  Another molecule with the same atom numbers</div>
</div>
</dd>
<dt>Return values:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">transformation</span></tt>  &#8211;  the transformation that brings &#8216;self&#8217; into
overlap with &#8216;other&#8217;</div>
<div class="line"><tt class="docutils literal"><span class="pre">other_trans</span></tt>  &#8211;  the transformed coordinates of geometry &#8216;other&#8217;</div>
<div class="line"><tt class="docutils literal"><span class="pre">rmsd</span></tt>  &#8211;  the rmsd of the distances between corresponding atoms in
&#8216;self&#8217; and &#8216;other&#8217;</div>
</div>
</dd>
</dl>
<p>Make sure the atoms in <cite>self</cite> and <cite>other</cite> are in the same order.</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">molecule1</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">molecule2</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">angstrom</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="molmod.molecules.Molecule.set_default_graph">
<tt class="descname">set_default_graph</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.set_default_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Set self.graph to the default graph.</p>
<p>This method is equivalent to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mol</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">MolecularGraph</span><span class="o">.</span><span class="n">from_geometry</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>with the default options, and only works if the graph object is not
present yet.
See <a class="reference internal" href="#molmod.molecular_graphs.MolecularGraph.from_geometry" title="molmod.molecular_graphs.MolecularGraph.from_geometry"><tt class="xref py py-meth docutils literal"><span class="pre">molmod.molecular_graphs.MolecularGraph.from_geometry()</span></tt></a>
for more fine-grained control over the assignment of bonds.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.molecules.Molecule.set_default_masses">
<tt class="descname">set_default_masses</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.set_default_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Set self.masses based on self.numbers and periodic table.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.molecules.Molecule.set_default_symbols">
<tt class="descname">set_default_symbols</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.set_default_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Set self.symbols based on self.numbers and the periodic table.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.size">
<tt class="descname">size</tt><a class="headerlink" href="#molmod.molecules.Molecule.size" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the number of atoms.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.symbols">
<tt class="descname">symbols</tt><a class="headerlink" href="#molmod.molecules.Molecule.symbols" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> symbols for the atoms, which can be element names for force-field atom types.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'tuple'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.title">
<tt class="descname">title</tt><a class="headerlink" href="#molmod.molecules.Molecule.title" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> a short description of the system.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'basestring'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecules.Molecule.unit_cell">
<tt class="descname">unit_cell</tt><a class="headerlink" href="#molmod.molecules.Molecule.unit_cell" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> description of the periodic boundary conditions.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;class</span> <span class="pre">'molmod.unit_cells.UnitCell'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="molmod.molecules.Molecule.write_to_file">
<tt class="descname">write_to_file</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#molmod.molecules.Molecule.write_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the molecular geometry to a file.</p>
<p>The file format is inferred from the extensions. Currently supported
formats are: <tt class="docutils literal"><span class="pre">*.xyz</span></tt>, <tt class="docutils literal"><span class="pre">*.cml</span></tt></p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">filename</span></tt>  &#8211;  a filename</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molmod.graphs">
<span id="molmod-graphs-abstract-graphs"></span><h2><a class="reference internal" href="#module-molmod.graphs" title="molmod.graphs"><tt class="xref py py-mod docutils literal"><span class="pre">molmod.graphs</span></tt></a> &#8211; Abstract graphs<a class="headerlink" href="#module-molmod.graphs" title="Permalink to this headline">¶</a></h2>
<p>Some distinctive features include:</p>
<ul class="simple">
<li>Iterating over all shortest paths between two vertices (Dijkstra). See
<a class="reference external" href="http://en.wikipedia.org/wiki/Dijkstra's_algorithm">http://en.wikipedia.org/wiki/Dijkstra&#8217;s_algorithm</a> for more info.</li>
<li>Iterating over vertices or edges using the Breadth First convention. See
<a class="reference external" href="http://en.wikipedia.org/wiki/Breadth-first_search">http://en.wikipedia.org/wiki/Breadth-first_search</a> for more info.</li>
<li>The all pairs shortest path matrix (Floyd-Warshall). See
<a class="reference external" href="http://en.wikipedia.org/wiki/Floyd-Warshall_algorithm">http://en.wikipedia.org/wiki/Floyd-Warshall_algorithm</a> for more info.</li>
<li>Symmetry analysis of graphs (automorphisms). The Graph class can generate a
list of permutations between vertices that map the graph onto itself. This
can be used to generate (and test) all possible geometric symmetries in a
molecule. See <a class="reference external" href="http://en.wikipedia.org/wiki/Graph_automorphism">http://en.wikipedia.org/wiki/Graph_automorphism</a> for more
info.</li>
<li>Scanning a graph for patterns.
The GraphSearch is a generic class that can scan a graph for certain
patterns, e.g. given pattern_graphs, strong rings, isomorphisms,
automorphisms, ... The pattern_graph can deal with (multiple sets of)
additional conditions that must be satisfied, such as &#8220;give me all
dihedral angles where the central atoms are carbons&#8221; without duplicates.</li>
</ul>
<p>The central class in this module is &#8216;Graph&#8217;. It caches most of the analysis
results, which implies that the graph structure can not be changed once the
object is created. If you feel the need to do this, just construct a new
graph object.</p>
<dl class="exception">
<dt id="molmod.graphs.GraphError">
<em class="property">exception </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">GraphError</tt><a class="headerlink" href="#molmod.graphs.GraphError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when something goes wrong in one of the graph algorithms</p>
</dd></dl>

<dl class="class">
<dt id="molmod.graphs.Graph">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">Graph</tt><big>(</big><em>edges</em>, <em>num_vertices=None</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph" title="Permalink to this definition">¶</a></dt>
<dd><p>An undirected graph, where edges have equal weight</p>
<p>The edges attribute is the most elementary and is always available. All
other attributes are optional.</p>
<p>Graphs are meant to be immutable objects. Once created they are not
supposed to be modified. If you want an adapted graph, create a new
object. The main reason is that all graph analysis work is cached in this
object. When the edges change, the cache becomes invalid and should be
erased. The latter is not supported as it is easier to create just a new
graph object with the modified edges.</p>
<p>If you want to associate data with vertices or edges, add custom
dictionary or list attributes to the graph object. This is the way to
work attributes that are not applicable to all vertices or edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">vertex_property</span> <span class="o">=</span> <span class="p">{</span><span class="n">vertex1</span><span class="p">:</span> <span class="n">blablabla</span><span class="p">,</span> <span class="n">vertex2</span><span class="p">:</span> <span class="n">blablabla</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">edge_property</span> <span class="o">=</span> <span class="p">{</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">vertex1</span><span class="p">,</span> <span class="n">vertex2</span><span class="p">]):</span> <span class="n">blablabla</span><span class="p">,</span> <span class="o">..</span><span class="p">}</span>
</pre></div>
</div>
<p>If a certain property applies to all vertices or edges, it is sometimes
more practical to work with lists or <tt class="docutils literal"><span class="pre">numpy</span></tt> arrays that have the same
ordering as the vertices or the edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># atom numbers of ethene</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">vertex_property</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># bond orders of ethene</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">edge_property</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">edges</span></tt> &#8211; <tt class="docutils literal"><span class="pre">tuple(frozenset([vertex1,</span> <span class="pre">vertex2]),</span> <span class="pre">...)</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">num_vertices</span></tt> &#8211; number of vertices</div>
</div>
</dd>
</dl>
<p>vertex1 to vertexN must be integers from 0 to N-1. If vertices above
the highest vertex value are not connected by edges, use the
num_vertices argument to tell what the total number of vertices is.</p>
<p>If the edges argument does not have the correct format, it will be
converted.</p>
<dl class="attribute">
<dt id="molmod.graphs.Graph.canonical_order">
<tt class="descname">canonical_order</tt><a class="headerlink" href="#molmod.graphs.Graph.canonical_order" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The vertices in a canonical or normalized order..</p>
<p>This routine will return a list of vertices in an order that does not
depend on the initial order, but only depends on the connectivity and
the return values of the function self.get_vertex_string.</p>
<p>Only the vertices that are involved in edges will be included. The
result can be given as first argument to self.get_subgraph, with
reduce=True as second argument. This will return a complete canonical
graph.</p>
<p>The routine is designed not to use symmetry relations that are
obtained with the GraphSearch routine. We also tried to create an
ordering that feels like natural, i.e. starting in the center and
pushing vertices with few equivalents to the front. If necessary, the
nature of the vertices and  their bonds to atoms closer to the center
will also play a role, but only as a last resort.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.central_vertex">
<tt class="descname">central_vertex</tt><a class="headerlink" href="#molmod.graphs.Graph.central_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The vertex that has the lowest maximum distance to any other vertex.</p>
<p>This definition does not lead to a unique solution. One arbitrary
solution is selected.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.central_vertices">
<tt class="descname">central_vertices</tt><a class="headerlink" href="#molmod.graphs.Graph.central_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Vertices that have the lowest maximum distance to any other vertex.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.distances">
<tt class="descname">distances</tt><a class="headerlink" href="#molmod.graphs.Graph.distances" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The matrix with the all-pairs shortest path lenghts.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.edge_index">
<tt class="descname">edge_index</tt><a class="headerlink" href="#molmod.graphs.Graph.edge_index" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> A map to look up the index of a edge.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.edges">
<tt class="descname">edges</tt><a class="headerlink" href="#molmod.graphs.Graph.edges" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the incidence list.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'tuple'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.equivalent_vertices">
<tt class="descname">equivalent_vertices</tt><a class="headerlink" href="#molmod.graphs.Graph.equivalent_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> A dictionary with symmetrically equivalent vertices..</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.fingerprint">
<tt class="descname">fingerprint</tt><a class="headerlink" href="#molmod.graphs.Graph.fingerprint" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> A total graph fingerprint.</p>
<p>The result is invariant under permutation of the vertex indexes. The
chance that two different (molecular) graphs yield the same
fingerprint is small but not zero. (See unit tests.)</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.full_match">
<tt class="descname">full_match</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.full_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the mapping between vertex indexes in self and other.</p>
<p>This also works on disconnected graphs. Derived classes should just
implement get_vertex_string and get_edge_string to make this method
aware of the different nature of certain vertices. In case molecules,
this would make the algorithm sensitive to atom numbers etc.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_edge_string">
<tt class="descname">get_edge_string</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_edge_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string that fully characterizes the nature of an edge</p>
<p>In case of an ordinary graph, all edges are the same.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_halfs">
<tt class="descname">get_halfs</tt><big>(</big><em>vertex1</em>, <em>vertex2</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_halfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the graph in two halfs by cutting the edge: vertex1-vertex2</p>
<p>If this is not possible (due to loops connecting both ends), a
GraphError is raised.</p>
<p>Returns the vertices in both halfs.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_halfs_double">
<tt class="descname">get_halfs_double</tt><big>(</big><em>vertex_a1</em>, <em>vertex_b1</em>, <em>vertex_a2</em>, <em>vertex_b2</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_halfs_double" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the two parts separated by <tt class="docutils literal"><span class="pre">(vertex_a1,</span> <span class="pre">vertex_b1)</span></tt> and <tt class="docutils literal"><span class="pre">(vertex_a2,</span> <span class="pre">vertex_b2)</span></tt></p>
<p>Raise a GraphError when <tt class="docutils literal"><span class="pre">(vertex_a1,</span> <span class="pre">vertex_b1)</span></tt> and
<tt class="docutils literal"><span class="pre">(vertex_a2,</span> <span class="pre">vertex_b2)</span></tt> do not separate the graph in two
disconnected parts. The edges must be neighbors. If not a GraphError
is raised. The for vertices must not coincide or a GraphError is
raised.</p>
<p>Returns the vertices of the two halfs and the four &#8216;hinge&#8217; vertices
in the correct order, i.e. both <tt class="docutils literal"><span class="pre">vertex_a1</span></tt> and <tt class="docutils literal"><span class="pre">vertex_a2</span></tt> are
in the first half and both <tt class="docutils literal"><span class="pre">vertex_b1</span></tt> and <tt class="docutils literal"><span class="pre">vertex_b2</span></tt> are in the
second half.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_part">
<tt class="descname">get_part</tt><big>(</big><em>vertex_in</em>, <em>vertices_border</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_part" title="Permalink to this definition">¶</a></dt>
<dd><p>List all vertices that are connected to vertex_in, but are not
included in or &#8216;behind&#8217; vertices_border.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_subgraph">
<tt class="descname">get_subgraph</tt><big>(</big><em>subvertices</em>, <em>normalize=False</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a subgraph of the current graph</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">subvertices</span></tt> &#8211; The vertices that should be retained.</div>
<div class="line"><tt class="docutils literal"><span class="pre">normalize</span></tt> &#8211; Whether or not the vertices should renumbered and
reduced to the given set of subvertices. When True, also the
edges are sorted. It the end, this means that new order of the
edges does not depend on the original order, but only on the
order of the argument subvertices.
This option is False by default. When False, only edges will be
discarded, but the retained data remain unchanged. Also the
parameter num_vertices is not affected.</div>
</div>
</dd>
</dl>
<p>The returned graph will have an attribute <tt class="docutils literal"><span class="pre">old_edge_indexes</span></tt> that
relates the positions of the new and the old edges as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">_old_edge_indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>In derived classes, the following should be supported:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">edge_property</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">_old_edge_indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">edge_property</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>When <tt class="docutils literal"><span class="pre">normalize==True</span></tt>, also the vertices are affected and the
derived classes should make sure that the following works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">vertex_property</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">_old_vertex_indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">vertex_property</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>The attribute <tt class="docutils literal"><span class="pre">old_vertex_indexes</span></tt> is only constructed when
<tt class="docutils literal"><span class="pre">normalize==True</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_vertex_fingerprints">
<tt class="descname">get_vertex_fingerprints</tt><big>(</big><em>vertex_strings</em>, <em>edge_strings</em>, <em>num_iter=None</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_vertex_fingerprints" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array with fingerprints for each vertex</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.get_vertex_string">
<tt class="descname">get_vertex_string</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.get_vertex_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string that fully characterizes the nature of the vertex</p>
<p>In case of an ordinary graph, all vertices are the same.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.independent_vertices">
<tt class="descname">independent_vertices</tt><a class="headerlink" href="#molmod.graphs.Graph.independent_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Lists of vertices that are only interconnected within each list.</p>
<p>This means that there is no path from a vertex in one list to a
vertex in another list. In case of a molecular graph, this would
yield the atoms that belong to individual molecules.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.iter_breadth_first">
<tt class="descname">iter_breadth_first</tt><big>(</big><em>start=None</em>, <em>do_paths=False</em>, <em>do_duplicates=False</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.iter_breadth_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the vertices with the breadth first algorithm.</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Breadth-first_search">http://en.wikipedia.org/wiki/Breadth-first_search</a> for more info.
If not start vertex is given, the central vertex is taken.</p>
<p>By default, the distance to the starting vertex is also computed. If
the path to the starting vertex should be computed instead, set path
to True.</p>
<p>When duplicate is True, then vertices that can be reached through
different  paths of equal length, will be iterated twice. This
typically only makes sense when path==True.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.iter_breadth_first_edges">
<tt class="descname">iter_breadth_first_edges</tt><big>(</big><em>start=None</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.iter_breadth_first_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the edges with the breadth first convention.</p>
<p>We need this for the pattern matching algorithms, but a quick look at
Wikipedia did not result in a known and named algorithm.</p>
<p>The edges are yielded one by one, together with the distance of the
edge from the starting vertex and a flag that indicates whether the
yielded edge connects two vertices that are at the same distance from
the starting vertex. If that flag is False, the distance from the
starting vertex to edge[0] is equal to the distance variable and the
distance from edge[1] to the starting vertex is equal to distance+1.
One item has the following format: ((i, j), distance, flag)</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Graph.iter_shortest_paths">
<tt class="descname">iter_shortest_paths</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#molmod.graphs.Graph.iter_shortest_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all the shortest paths between vertex a and b.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.max_distance">
<tt class="descname">max_distance</tt><a class="headerlink" href="#molmod.graphs.Graph.max_distance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The maximum value in the distances matrix..</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.neighbors">
<tt class="descname">neighbors</tt><a class="headerlink" href="#molmod.graphs.Graph.neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> A dictionary with neighbors.</p>
<p>The dictionary will have the following form:
<tt class="docutils literal"><span class="pre">{vertexX:</span> <span class="pre">(vertexY1,</span> <span class="pre">vertexY2,</span> <span class="pre">...),</span> <span class="pre">...}</span></tt>
This means that vertexX and vertexY1 are connected etc. This also
implies that the following elements are part of the dictionary:
<tt class="docutils literal"><span class="pre">{vertexY1:</span> <span class="pre">(vertexX,</span> <span class="pre">...),</span> <span class="pre">vertexY2:</span> <span class="pre">(vertexX,</span> <span class="pre">...),</span> <span class="pre">...}</span></tt>.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.num_edges">
<tt class="descname">num_edges</tt><a class="headerlink" href="#molmod.graphs.Graph.num_edges" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the number of edges in the graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.num_vertices">
<tt class="descname">num_vertices</tt><a class="headerlink" href="#molmod.graphs.Graph.num_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the number of vertices.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'int'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.symmetries">
<tt class="descname">symmetries</tt><a class="headerlink" href="#molmod.graphs.Graph.symmetries" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Graph symmetries (permutations) that map the graph onto itself..</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.symmetry_cycles">
<tt class="descname">symmetry_cycles</tt><a class="headerlink" href="#molmod.graphs.Graph.symmetry_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The cycle representations of the graph symmetries.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Graph.vertex_fingerprints">
<tt class="descname">vertex_fingerprints</tt><a class="headerlink" href="#molmod.graphs.Graph.vertex_fingerprints" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> A fingerprint for each vertex.</p>
<p>The result is invariant under permutation of the vertex indexes.
Vertices that are symmetrically equivalent will get the same
fingerprint, e.g. the hydrogens in methane would get the same
fingerprint.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.OneToOne">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">OneToOne</tt><big>(</big><em>relations=None</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements a discrete bijection between source and destination elements</p>
<p>The implementation is based on a consistent set of forward and reverse
relations, stored in dictionaries.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">relations</span></tt>  &#8211;  initial relations for the bijection</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.OneToOne.add_relation">
<tt class="descname">add_relation</tt><big>(</big><em>source</em>, <em>destination</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.add_relation" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new a relation to the bejection</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.OneToOne.add_relations">
<tt class="descname">add_relations</tt><big>(</big><em>relations</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.add_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>Add multiple relations to a bijection</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.OneToOne.get_destination">
<tt class="descname">get_destination</tt><big>(</big><em>source</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.get_destination" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the end point of a relation that start with &#8216;source&#8217;</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.OneToOne.get_source">
<tt class="descname">get_source</tt><big>(</big><em>destination</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.get_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the starting point of a relation that ends with &#8216;destination&#8217;</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.OneToOne.in_destinations">
<tt class="descname">in_destinations</tt><big>(</big><em>destination</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.in_destinations" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if the given destination is present</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.OneToOne.in_sources">
<tt class="descname">in_sources</tt><big>(</big><em>source</em><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.in_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if the given source is present</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.OneToOne.inverse">
<tt class="descname">inverse</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.graphs.OneToOne.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inverse bijection.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.Match">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">Match</tt><big>(</big><em>relations=None</em><big>)</big><a class="headerlink" href="#molmod.graphs.Match" title="Permalink to this definition">¶</a></dt>
<dd><p>A match between a pattern and a graph</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">relations</span></tt>  &#8211;  initial relations for the bijection</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.Match.copy_with_new_relations">
<tt class="descname">copy_with_new_relations</tt><big>(</big><em>new_relations</em><big>)</big><a class="headerlink" href="#molmod.graphs.Match.copy_with_new_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new match object extended with new relations</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.graphs.Match.from_first_relation">
<em class="property">classmethod </em><tt class="descname">from_first_relation</tt><big>(</big><em>vertex0</em>, <em>vertex1</em><big>)</big><a class="headerlink" href="#molmod.graphs.Match.from_first_relation" title="Permalink to this definition">¶</a></dt>
<dd><p>Intialize a fresh match based on the first relation</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Match.get_new_edges">
<tt class="descname">get_new_edges</tt><big>(</big><em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.Match.get_new_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get new edges from the subject graph for the graph search algorithm</p>
<p>The Graph search algorithm extends the matches iteratively by adding
matching vertices that are one edge further from the starting vertex
at each iteration.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.Pattern">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">Pattern</tt><a class="headerlink" href="#molmod.graphs.Pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for a pattern in a graph.</p>
<p>Note the following conventions:</p>
<ul class="simple">
<li>A pattern can always be represented by a graph (or a set of graphs)
and some additional conditions. This graph is the so called &#8216;PATTERN
GRAPH&#8217;. For technical reasons, this pattern graph is not always
constructed explicitly. Variables related to this graph often get
suffix &#8216;0&#8217;. Note that a pattern graph is always fully connected.</li>
<li>The graph in which we search for the pattern, is called the &#8216;SUBJECT
GRAPH&#8217;. Variables related to this graph often get suffix &#8216;1&#8217;.</li>
</ul>
<dl class="attribute">
<dt id="molmod.graphs.Pattern.MatchClass">
<tt class="descname">MatchClass</tt><a class="headerlink" href="#molmod.graphs.Pattern.MatchClass" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#molmod.graphs.Match" title="molmod.graphs.Match"><tt class="xref py py-class docutils literal"><span class="pre">Match</span></tt></a></p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.check_next_match">
<tt class="descname">check_next_match</tt><big>(</big><em>match</em>, <em>new_relations</em>, <em>subject_graph</em>, <em>one_match</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.check_next_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Does this match object make sense for the current pattern</p>
<p>Return False if some symmetry or other considerations are not
satisfied. The checks in this function are typically only possible by
considering the whole instead of looking just at a few
vertices/edges/relations.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.check_symmetry">
<tt class="descname">check_symmetry</tt><big>(</big><em>new_relations</em>, <em>current_match</em>, <em>next_match</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.check_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Off all symmetric <tt class="docutils literal"><span class="pre">new_relations</span></tt>, only allow one</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.compare">
<tt class="descname">compare</tt><big>(</big><em>vertex0</em>, <em>vertex1</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if <tt class="docutils literal"><span class="pre">vertex0</span></tt> and <tt class="docutils literal"><span class="pre">vertex1</span></tt> can be equal</p>
<p>False positives are allowed, but the less false positives, the more
efficient the <a class="reference internal" href="#molmod.graphs.GraphSearch" title="molmod.graphs.GraphSearch"><tt class="xref py py-class docutils literal"><span class="pre">GraphSearch</span></tt></a> will be.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.complete">
<tt class="descname">complete</tt><big>(</big><em>match</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <tt class="docutils literal"><span class="pre">True</span></tt> if no more additional relations are required</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.get_new_edges">
<tt class="descname">get_new_edges</tt><big>(</big><em>level</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.get_new_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get new edges from the pattern graph for the graph search algorithm</p>
<p>The level argument denotes the distance of the new edges from the
starting vertex in the pattern graph.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.iter_final_matches">
<tt class="descname">iter_final_matches</tt><big>(</big><em>match</em>, <em>subject_graph</em>, <em>one_match</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.iter_final_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Just return the original match</p>
<p>Derived classes can specialize here to make efficient use of
symmetries</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.Pattern.iter_initial_relations">
<tt class="descname">iter_initial_relations</tt><big>(</big><em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.Pattern.iter_initial_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all initial relations to start a Graph Search</p>
<p>The function iterates of single relations between a pattern vertex
and a subject vertex. In practice it is sufficient to select one
vertex in the pattern and then associate it with each (reasonable)
vertex in the subject graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.Pattern.sub">
<tt class="descname">sub</tt><em class="property"> = True</em><a class="headerlink" href="#molmod.graphs.Pattern.sub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.CriteriaSet">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">CriteriaSet</tt><big>(</big><em>vertex_criteria=None</em>, <em>edge_criteria=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#molmod.graphs.CriteriaSet" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of criteria that can be associated with a custum pattern.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">vertex_criteria</span></tt>  &#8211;  a dictionary with criteria for the
vertices, <tt class="docutils literal"><span class="pre">key=vertex_index</span></tt>,
<tt class="docutils literal"><span class="pre">value=criterion</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">edge_criteria</span></tt>  &#8211;  a dictionary with criteria for the edges
<tt class="docutils literal"><span class="pre">key=edge_index</span></tt>, <tt class="docutils literal"><span class="pre">value=criterion</span></tt></div>
</div>
</dd>
</dl>
<p>Any other keyword argument will be assigned as attribute to matches
that fulfill the criteria of this set.</p>
<dl class="method">
<dt id="molmod.graphs.CriteriaSet.test_match">
<tt class="descname">test_match</tt><big>(</big><em>match</em>, <em>pattern_graph</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CriteriaSet.test_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a match satisfies the criteria</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.Anything">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">Anything</tt><a class="headerlink" href="#molmod.graphs.Anything" title="Permalink to this definition">¶</a></dt>
<dd><p>A criterion that always returns True</p>
<dl class="method">
<dt id="molmod.graphs.Anything.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.Anything.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns True</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.CritOr">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">CritOr</tt><big>(</big><em>*criteria</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritOr" title="Permalink to this definition">¶</a></dt>
<dd><p>OR Operator for criteria objects</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">criteria</span></tt>  &#8211;  a list of criteria to apply the OR operation to.</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.CritOr.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritOr.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates all the criteria and applies an OR opartion</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion
is applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.CritAnd">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">CritAnd</tt><big>(</big><em>*criteria</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritAnd" title="Permalink to this definition">¶</a></dt>
<dd><p>AND Operator for criteria objects</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">criteria</span></tt>  &#8211;  a list of criteria to apply the AND operation to</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.CritAnd.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritAnd.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates all the criteria and applies an AND opartion</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion
is applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.CritXor">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">CritXor</tt><big>(</big><em>*criteria</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritXor" title="Permalink to this definition">¶</a></dt>
<dd><p>XOR Operator for criteria objects</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">criteria</span></tt>  &#8211;  a list of criteria to apply the XOR operation to.</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.CritXor.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritXor.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates all the criteria and applies a generalized XOR opartion</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion
is applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
<p>when the XOR operation is applied to more than two criteria, True
is only returned when an odd number of criteria return True.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.CritNot">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">CritNot</tt><big>(</big><em>criterion</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritNot" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverion of another criterion</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">criterion</span></tt>  &#8211;  another criterion object</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.CritNot.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CritNot.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates all the criterion and applies an inversion opartion</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion is
applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.CustomPattern">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">CustomPattern</tt><big>(</big><em>pattern_graph</em>, <em>criteria_sets=None</em>, <em>vertex_tags=None</em>, <em>start_vertex=None</em><big>)</big><a class="headerlink" href="#molmod.graphs.CustomPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>A pattern based on a given pattern graph</p>
<p>The pattern graph can be complemented with additional criteria for the
vertices and edges. Additionally the effective symmetry of the pattern
graph can be reduced by tagging the vertices in the pattern graph with
different labels.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">pattern_graph</span></tt> &#8211; the pattern that has to be found in the subject
graph.</div>
<div class="line"><tt class="docutils literal"><span class="pre">criteria_sets</span></tt> &#8211; Criteria sets associate additional conditions
with vertices and edges, and can also introduce
global match conditions.</div>
<div class="line"><tt class="docutils literal"><span class="pre">vertex_tags</span></tt> &#8211; vertex tags can reduce the symmetry of the
pattern_graph pattern. An example case where this is useful:
Consider atoms 0, 1, 2 that are bonded in this order. We want to
compute the distance from atom 2 to the line (0, 1). In this case
the matches (0-&gt;a, 1-&gt;b, 2-&gt;c) and (0-&gt;c, 1-&gt;b, 2-&gt;a) correspond
to different internal coordinates. We want the graph search to
return the two solutions. In order to do this, set
<tt class="docutils literal"><span class="pre">vertex_tags={0:0,</span> <span class="pre">1:0,</span> <span class="pre">2:1}</span></tt>. This means that vertex 0 and 1
are equivalent, but that vertex 2 has a different nature. In the
case of a bending angle, only one match like (0-&gt;a, 1-&gt;b, 2-&gt;c) is
sufficient and we do not want to reduce the symmetry of the
<tt class="docutils literal"><span class="pre">pattern_graph</span></tt>. In this case, one should not use vertex_tags at
all.</div>
<div class="line"><tt class="docutils literal"><span class="pre">start_vertex</span></tt>  &#8211;  The first vertex in the pattern graph that is
linked with a vertex in the subject graph. A wise choice can
improve the performance of a graph search. If not given, the
central vertex is take as start_vertex</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.CustomPattern.check_next_match">
<tt class="descname">check_next_match</tt><big>(</big><em>match</em>, <em>new_relations</em>, <em>subject_graph</em>, <em>one_match</em><big>)</big><a class="headerlink" href="#molmod.graphs.CustomPattern.check_next_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the (onset for a) match can be a valid</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.CustomPattern.complete">
<tt class="descname">complete</tt><big>(</big><em>match</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CustomPattern.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True of the match is complete</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.CustomPattern.get_new_edges">
<tt class="descname">get_new_edges</tt><big>(</big><em>level</em><big>)</big><a class="headerlink" href="#molmod.graphs.CustomPattern.get_new_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get new edges from the pattern graph for the graph search algorithm</p>
<p>The level argument denotes the distance of the new edges from the
starting vertex in the pattern graph.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.CustomPattern.iter_final_matches">
<tt class="descname">iter_final_matches</tt><big>(</big><em>canonical_match</em>, <em>subject_graph</em>, <em>one_match</em><big>)</big><a class="headerlink" href="#molmod.graphs.CustomPattern.iter_final_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a match, iterate over all related equivalent matches</p>
<p>When criteria sets are defined, the iterator runs over all symmetric
equivalent matches that fulfill one of the criteria sets. When not
criteria sets are defined, the iterator only yields the input match.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.CustomPattern.iter_initial_relations">
<tt class="descname">iter_initial_relations</tt><big>(</big><em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.CustomPattern.iter_initial_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all valid initial relations for a match</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.EqualPattern">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">EqualPattern</tt><big>(</big><em>pattern_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.EqualPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Like CustomPattern, but the pattern has the same size as the subject graph</p>
<p>See <tt class="xref py py-meth docutils literal"><span class="pre">CustomPattern.__init__()</span></tt></p>
<dl class="attribute">
<dt id="molmod.graphs.EqualPattern.MatchClass">
<tt class="descname">MatchClass</tt><a class="headerlink" href="#molmod.graphs.EqualPattern.MatchClass" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <tt class="xref py py-class docutils literal"><span class="pre">EqualMatch</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.EqualPattern.compare">
<tt class="descname">compare</tt><big>(</big><em>vertex0</em>, <em>vertex1</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.EqualPattern.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true when the two vertices are of the same kind</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.EqualPattern.iter_initial_relations">
<tt class="descname">iter_initial_relations</tt><big>(</big><em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.EqualPattern.iter_initial_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all valid initial relations for a match</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.graphs.EqualPattern.sub">
<tt class="descname">sub</tt><em class="property"> = False</em><a class="headerlink" href="#molmod.graphs.EqualPattern.sub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.RingPattern">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">RingPattern</tt><big>(</big><em>max_size</em><big>)</big><a class="headerlink" href="#molmod.graphs.RingPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>A pattern that matches strong rings up to a given size</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">max_size</span></tt>  &#8211;  the maximum number of vertices in a ring</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.RingPattern.check_next_match">
<tt class="descname">check_next_match</tt><big>(</big><em>match</em>, <em>new_relations</em>, <em>subject_graph</em>, <em>one_match</em><big>)</big><a class="headerlink" href="#molmod.graphs.RingPattern.check_next_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the (onset for a) match can be a valid (part of a) ring</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.RingPattern.complete">
<tt class="descname">complete</tt><big>(</big><em>match</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.RingPattern.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the completeness of a ring match</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.RingPattern.get_new_edges">
<tt class="descname">get_new_edges</tt><big>(</big><em>level</em><big>)</big><a class="headerlink" href="#molmod.graphs.RingPattern.get_new_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get new edges from the pattern graph for the graph search algorithm</p>
<p>The level argument denotes the distance of the new edges from the
starting vertex in the pattern graph.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.RingPattern.iter_initial_relations">
<tt class="descname">iter_initial_relations</tt><big>(</big><em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.graphs.RingPattern.iter_initial_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all valid initial relations for a match</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.graphs.GraphSearch">
<em class="property">class </em><tt class="descclassname">molmod.graphs.</tt><tt class="descname">GraphSearch</tt><big>(</big><em>pattern</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#molmod.graphs.GraphSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>An algorithm that searches for all matches of a pattern in a graph</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gs</span> <span class="o">=</span> <span class="n">GraphSearch</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">forward</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">pattern</span></tt>  &#8211;  A Pattern instance, describing the pattern to
look for</div>
<div class="line"><tt class="docutils literal"><span class="pre">debug</span></tt>  &#8211;  When true, debugging info is printed on screen
[default=False]</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.graphs.GraphSearch.__call__">
<tt class="descname">__call__</tt><big>(</big><em>subject_graph</em>, <em>one_match=False</em><big>)</big><a class="headerlink" href="#molmod.graphs.GraphSearch.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over all matches of self.pattern in the given graph.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line">subject_graph  &#8211;  The subject_graph in which the matches
according to self.pattern have to be found.</div>
<div class="line">one_match &#8211;  If True, only one match will be returned. This
allows certain optimizations.</div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="molmod.graphs.GraphSearch.print_debug">
<tt class="descname">print_debug</tt><big>(</big><em>text</em>, <em>indent=0</em><big>)</big><a class="headerlink" href="#molmod.graphs.GraphSearch.print_debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Only prints debug info on screen when self.debug == True.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="molmod-molecular-graphs-molecular-graphs">
<h2><a class="reference internal" href="#module-molmod.molecular_graphs" title="molmod.molecular_graphs"><tt class="xref py py-mod docutils literal"><span class="pre">molmod.molecular_graphs</span></tt></a> &#8211; Molecular graphs<a class="headerlink" href="#molmod-molecular-graphs-molecular-graphs" title="Permalink to this headline">¶</a></h2>
<p>This is an extension of the Graph object with molecular features.</p>
<span class="target" id="module-molmod.molecular_graphs"></span><dl class="class">
<dt id="molmod.molecular_graphs.MolecularGraph">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">MolecularGraph</tt><big>(</big><em>edges</em>, <em>numbers</em>, <em>orders=None</em>, <em>symbols=None</em>, <em>num_vertices=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes a molecular graph: connectivity, atom numbers and bond orders.</p>
<p>This class inherits all features from the Graph class and adds methods
and attributes that are specific from molecular graphs. Instances are
immutable, so if you want to modify a molecular graph, just instantiate a
new object with modified connectivity, numbers and orders. The advantage
is that various graph analysis and properties can be cached.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">edges</span></tt>  &#8211;  See base class (Graph) documentation</div>
<div class="line"><tt class="docutils literal"><span class="pre">numbers</span></tt>  &#8211;  consecutive atom numbers</div>
</div>
</dd>
<dt>Optional arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">orders</span></tt>  &#8211;  bond orders</div>
<div class="line"><tt class="docutils literal"><span class="pre">symbols</span></tt>  &#8211;  atomic symbols</div>
<div class="line"><tt class="docutils literal"><span class="pre">num_vertices</span></tt>  &#8211;  must be the same as the number of atoms or None</div>
</div>
</dd>
</dl>
<p>When the nature of an atom or a bond is unclear ambiguous, set the
corresponding integer to zero. This means the nature of the atom or
bond is unspecified. When the bond orders are not given, they are all
set to  zero.</p>
<p>If you want to use &#8216;special&#8217; atom types, use negative numbers. The
same for bond orders. e.g. a nice choice for the bond order of a
hybrid bond is -1.</p>
<dl class="method">
<dt id="molmod.molecular_graphs.MolecularGraph.add_hydrogens">
<tt class="descname">add_hydrogens</tt><big>(</big><em>formal_charges=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.add_hydrogens" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a molecular graph where hydrogens are added explicitely</p>
<p>When the bond order is unknown, it assumes bond order one. If the
graph  has an attribute formal_charges, this routine will take it
into account when counting the number of hydrogens to be added. The
returned graph will also have a formal_charges attribute.</p>
<p>This routine only adds hydrogen atoms for a limited set of atoms from
the periodic system: B, C, N, O, F, Al, Si, P, S, Cl, Br.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecular_graphs.MolecularGraph.blob">
<tt class="descname">blob</tt><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.blob" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> A compact text representation of the graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecular_graphs.MolecularGraph.edges">
<tt class="descname">edges</tt><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.edges" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the incidence list.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'tuple'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.molecular_graphs.MolecularGraph.from_blob">
<em class="property">classmethod </em><tt class="descname">from_blob</tt><big>(</big><em>s</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.from_blob" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a molecular graph from the blob representation</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.molecular_graphs.MolecularGraph.from_geometry">
<em class="property">classmethod </em><tt class="descname">from_geometry</tt><big>(</big><em>molecule</em>, <em>do_orders=False</em>, <em>scaling=1.0</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.from_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a MolecularGraph object based on interatomic distances</p>
<p>All short distances are computed with the binning module and compared
with a database of bond lengths. Based on this comparison, bonded
atoms are detected.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">molecule</span></tt>  &#8211;  The molecule to derive the graph from</div>
</div>
</dd>
<dt>Optional arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">do_orders</span></tt>  &#8211;  set to True to estimate the bond order</div>
<div class="line"><tt class="docutils literal"><span class="pre">scaling</span></tt>  &#8211;  scale the threshold for the connectivity. increase
this to 1.5 in case of transition states when a
fully connected topology is required.</div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="molmod.molecular_graphs.MolecularGraph.get_edge_string">
<tt class="descname">get_edge_string</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.get_edge_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string based on the bond order</p>
</dd></dl>

<dl class="method">
<dt id="molmod.molecular_graphs.MolecularGraph.get_subgraph">
<tt class="descname">get_subgraph</tt><big>(</big><em>subvertices</em>, <em>normalize=False</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.get_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a subgraph of the current graph</p>
<p>See <a class="reference internal" href="#molmod.graphs.Graph.get_subgraph" title="molmod.graphs.Graph.get_subgraph"><tt class="xref py py-meth docutils literal"><span class="pre">molmod.graphs.Graph.get_subgraph()</span></tt></a> for more information.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.molecular_graphs.MolecularGraph.get_vertex_string">
<tt class="descname">get_vertex_string</tt><big>(</big><em>i</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.get_vertex_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string based on the atom number</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecular_graphs.MolecularGraph.num_vertices">
<tt class="descname">num_vertices</tt><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.num_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the number of vertices.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'int'&gt;</span></tt></li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecular_graphs.MolecularGraph.numbers">
<tt class="descname">numbers</tt><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.numbers" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the atomic numbers associated with the vertices.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'int'&gt;</span></tt>.</li>
<li>Special conditions: the number of vertices and atomic numbers must be the same.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecular_graphs.MolecularGraph.orders">
<tt class="descname">orders</tt><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.orders" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the bond orders associated with the edges.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
<li>Special conditions: the number of edges and bond orders must be the same.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.molecular_graphs.MolecularGraph.symbols">
<tt class="descname">symbols</tt><a class="headerlink" href="#molmod.molecular_graphs.MolecularGraph.symbols" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> symbols for the atoms, which can be element names for force-field atom types.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'tuple'&gt;</span></tt></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.HasAtomNumber">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">HasAtomNumber</tt><big>(</big><em>number</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasAtomNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Criterion for the atom number of a vertex</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">number</span></tt>  &#8211;  the expected atom number</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.molecular_graphs.HasAtomNumber.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasAtomNumber.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True only if the atom number is correct</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion is
applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.HasNumNeighbors">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">HasNumNeighbors</tt><big>(</big><em>count</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasNumNeighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Criterion for the number of neighboring vertexes</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">count</span></tt>  &#8211;  the expected number of neighbors</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.molecular_graphs.HasNumNeighbors.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasNumNeighbors.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True only if the number of neighbors is correct</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion is
applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.HasNeighborNumbers">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">HasNeighborNumbers</tt><big>(</big><em>*numbers</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasNeighborNumbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Criterion for the atom numbers of the neighbor vertexes</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">*numbers</span></tt>  &#8211;  a list with atom numbers</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.molecular_graphs.HasNeighborNumbers.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasNeighborNumbers.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True only if each neighbor can be linked with an atom number</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion is
applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.HasNeighbors">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">HasNeighbors</tt><big>(</big><em>*neighbor_criteria</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasNeighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if the neighbors of a vertex match the given criteria</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">*neighbor_criteria</span></tt>  &#8211;  a list of criteria objects</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.molecular_graphs.HasNeighbors.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.HasNeighbors.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True only if each neighbor can be linked with a positive criterion</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion is
applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.BondLongerThan">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">BondLongerThan</tt><big>(</big><em>length</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.BondLongerThan" title="Permalink to this definition">¶</a></dt>
<dd><p>A vertex criterion to select bonds longer than a given threshold</p>
<p>This criterion assumes that the molecular graph has an attribute
self.bond_lengths</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">length</span></tt> &#8211; the minimum length of the bond</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.molecular_graphs.BondLongerThan.__call__">
<tt class="descname">__call__</tt><big>(</big><em>index</em>, <em>graph</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.BondLongerThan.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True only if the bond is longer than the threshold</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">index</span></tt>  &#8211;  the index of the vertex/edge on which the criterion is
applied</div>
<div class="line"><tt class="docutils literal"><span class="pre">graph</span></tt>  &#8211;  the graph on which the criterion is tested</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="molmod.molecular_graphs.atom_criteria">
<tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">atom_criteria</tt><big>(</big><em>*params</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.atom_criteria" title="Permalink to this definition">¶</a></dt>
<dd><p>An auxiliary function to construct a dictionary of Criteria</p>
</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.BondPattern">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">BondPattern</tt><big>(</big><em>criteria_sets=None</em>, <em>vertex_tags=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.BondPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Pattern for two consecutive vertices</p>
<p>Arguments: see <a class="reference internal" href="#molmod.graphs.CustomPattern" title="molmod.graphs.CustomPattern"><tt class="xref py py-class docutils literal"><span class="pre">molmod.graphs.CustomPattern</span></tt></a></p>
</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.BendingAnglePattern">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">BendingAnglePattern</tt><big>(</big><em>criteria_sets=None</em>, <em>vertex_tags=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.BendingAnglePattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Pattern for three consecutive vertices</p>
<p>Arguments: see <a class="reference internal" href="#molmod.graphs.CustomPattern" title="molmod.graphs.CustomPattern"><tt class="xref py py-class docutils literal"><span class="pre">molmod.graphs.CustomPattern</span></tt></a></p>
</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.DihedralAnglePattern">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">DihedralAnglePattern</tt><big>(</big><em>criteria_sets=None</em>, <em>vertex_tags=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.DihedralAnglePattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Pattern for four consecutive vertices</p>
<p>Arguments: see <a class="reference internal" href="#molmod.graphs.CustomPattern" title="molmod.graphs.CustomPattern"><tt class="xref py py-class docutils literal"><span class="pre">molmod.graphs.CustomPattern</span></tt></a></p>
</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.OutOfPlanePattern">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">OutOfPlanePattern</tt><big>(</big><em>criteria_sets=None</em>, <em>vertex_tags=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.OutOfPlanePattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Pattern for a central vertex connected to three other vertices</p>
<p>Arguments: see <a class="reference internal" href="#molmod.graphs.CustomPattern" title="molmod.graphs.CustomPattern"><tt class="xref py py-class docutils literal"><span class="pre">molmod.graphs.CustomPattern</span></tt></a></p>
</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.TetraPattern">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">TetraPattern</tt><big>(</big><em>criteria_sets=None</em>, <em>vertex_tags=None</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.TetraPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Pattern for a central vertex connected to four other vertices</p>
<p>Arguments: see <a class="reference internal" href="#molmod.graphs.CustomPattern" title="molmod.graphs.CustomPattern"><tt class="xref py py-class docutils literal"><span class="pre">molmod.graphs.CustomPattern</span></tt></a></p>
</dd></dl>

<dl class="class">
<dt id="molmod.molecular_graphs.NRingPattern">
<em class="property">class </em><tt class="descclassname">molmod.molecular_graphs.</tt><tt class="descname">NRingPattern</tt><big>(</big><em>size</em>, <em>criteria_sets=None</em>, <em>vertex_tags=None</em>, <em>strong=False</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.NRingPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Pattern for strong rings with a fixed size</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">size</span></tt>  &#8211;  the size of the ring</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.molecular_graphs.NRingPattern.check_next_match">
<tt class="descname">check_next_match</tt><big>(</big><em>match</em>, <em>new_relations</em>, <em>subject_graph</em>, <em>one_match</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.NRingPattern.check_next_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the (onset for a) match can be a valid (part of a) ring</p>
</dd></dl>

<dl class="method">
<dt id="molmod.molecular_graphs.NRingPattern.complete">
<tt class="descname">complete</tt><big>(</big><em>match</em>, <em>subject_graph</em><big>)</big><a class="headerlink" href="#molmod.molecular_graphs.NRingPattern.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the completeness of the ring match</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molmod.unit_cells">
<span id="molmod-unit-cells-periodic-boundary-conditions"></span><h2><a class="reference internal" href="#module-molmod.unit_cells" title="molmod.unit_cells"><tt class="xref py py-mod docutils literal"><span class="pre">molmod.unit_cells</span></tt></a> &#8211; Periodic boundary conditions<a class="headerlink" href="#module-molmod.unit_cells" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="molmod.unit_cells.UnitCell">
<em class="property">class </em><tt class="descclassname">molmod.unit_cells.</tt><tt class="descname">UnitCell</tt><big>(</big><em>matrix</em>, <em>active=None</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell" title="Permalink to this definition">¶</a></dt>
<dd><p>Extensible representation of a unit cell.</p>
<p>Most attributes of the UnitCell object are treated as constants. If you
want to modify the unit cell, just create a modified UnitCell
object. This facilitates the caching of derived quantities such as the
distance matrices, while it imposes a cleaner coding style without
a significant computational overhead.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">matrix</span></tt>  &#8211;  the array with cell vectors. each column
corresponds to a single cell vector.</div>
</div>
</dd>
<dt>Optional argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">active</span></tt>  &#8211;  an array with three boolean values indicating
which cell vectors are active. [default: all three
True]</div>
</div>
</dd>
</dl>
<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.active">
<tt class="descname">active</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.active" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the active cell vectors.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have shape (3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'bool'&gt;</span></tt>.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.active_inactive">
<tt class="descname">active_inactive</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.active_inactive" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The indexes of the active and the inactive cell vectors.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.unit_cells.UnitCell.add_cell_vector">
<tt class="descname">add_cell_vector</tt><big>(</big><em>vector</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.add_cell_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new unit cell with an additional cell vector</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.alignment_a">
<tt class="descname">alignment_a</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.alignment_a" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Computes the rotation matrix that aligns the unit cell with the.
Cartesian axes, starting with cell vector a.</p>
<ul class="simple">
<li>a parallel to x</li>
<li>b in xy-plane with b_y positive</li>
<li>c with c_z positive</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.alignment_c">
<tt class="descname">alignment_c</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.alignment_c" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Computes the rotation matrix that aligns the unit cell with the.
Cartesian axes, starting with cell vector c.</p>
<ul class="simple">
<li>c parallel to z</li>
<li>b in zy-plane with b_y positive</li>
<li>a with a_x positive</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.eps">
<tt class="descname">eps</tt><em class="property"> = 1e-06</em><a class="headerlink" href="#molmod.unit_cells.UnitCell.eps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="molmod.unit_cells.UnitCell.from_parameters3">
<em class="property">classmethod </em><tt class="descname">from_parameters3</tt><big>(</big><em>lengths</em>, <em>angles</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.from_parameters3" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a 3D unit cell with the given parameters</p>
<p>The a vector is always parallel with the x-axis and they point in the
same direction. The b vector is always in the xy plane and points
towards the positive y-direction. The c vector points towards the
positive z-direction.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.unit_cells.UnitCell.get_radius_indexes">
<tt class="descname">get_radius_indexes</tt><big>(</big><em>radius</em>, <em>max_ranges=None</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.get_radius_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indexes of the interacting neighboring unit cells</p>
<p>Interacting neighboring unit cells have at least one point in their
box volume that has a distance smaller or equal than radius to at
least one point in the central cell. This concept is of importance
when computing pair wise long-range interactions in periodic systems.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">radius</span></tt>  &#8211;  the radius of the interaction sphere</div>
</div>
</dd>
<dt>Optional argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">max_ranges</span></tt>  &#8211;  numpy array with three elements: The maximum
ranges of indexes to consider. This is
practical when working with the minimum image
convention to reduce the generated bins to the
minimum image. (see binning.py) Use -1 to
avoid such limitations. The default is three
times -1.</div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="molmod.unit_cells.UnitCell.get_radius_ranges">
<tt class="descname">get_radius_ranges</tt><big>(</big><em>radius</em>, <em>mic=False</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.get_radius_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ranges of indexes of the interacting neighboring unit cells</p>
<p>Interacting neighboring unit cells have at least one point in their
box volume that has a distance smaller or equal than radius to at
least one point in the central cell. This concept is of importance
when computing pair wise long-range interactions in periodic systems.</p>
<p>The mic (stands for minimum image convention) option can be used to
change the behavior of this routine such that only neighboring cells
are considered that have at least one point withing a distance below
<cite>radius</cite> from the center of the reference cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.matrix">
<tt class="descname">matrix</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> matrix whose columns are the primitive cell vectors.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 2.</li>
<li>Must have shape (3, 3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.ordered">
<tt class="descname">ordered</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.ordered" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> An equivalent unit cell with the active cell vectors coming first.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.parameters">
<tt class="descname">parameters</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The cell parameters (lengths and angles).</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.reciprocal">
<tt class="descname">reciprocal</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.reciprocal" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The reciprocal of the unit cell.</p>
<p>In case of a three-dimensional periodic system, this is trivially the
transpose of the inverse of the cell matrix. This means that each
column of the matrix corresponds to a reciprocal cell vector. In case
of lower-dimensional periodicity, the inactive columns are zero, and
the active columns span the same sub space as the original cell
vectors.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.unit_cells.UnitCell.shortest_vector">
<tt class="descname">shortest_vector</tt><big>(</big><em>delta</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.shortest_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the relative vector under periodic boundary conditions.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">delta</span></tt>  &#8211;  the relative vector between two points</div>
</div>
</dd>
</dl>
<p>The return value is not necessarily the shortest possible vector,
but instead is the vector with fractional coordinates in the range
[-0.5,0.5[. This is most of the times the shortest vector between
the two points, but not always. (See commented test.) It is always
the shortest vector for orthorombic cells.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.spacings">
<tt class="descname">spacings</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.spacings" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Computes the distances between neighboring crystal planes.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.unit_cells.UnitCell.to_cartesian">
<tt class="descname">to_cartesian</tt><big>(</big><em>fractional</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts fractional to Cartesian coordinates</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">fractional</span></tt>  &#8211;  Can be a numpy array with shape (3, ) or with shape
(N, 3).</div>
</div>
</dd>
</dl>
<p>The return value has the same shape as the argument. This function is
the inverse of to_fractional.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.unit_cells.UnitCell.to_fractional">
<tt class="descname">to_fractional</tt><big>(</big><em>cartesian</em><big>)</big><a class="headerlink" href="#molmod.unit_cells.UnitCell.to_fractional" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Cartesian to fractional coordinates</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">cartesian</span></tt>  &#8211;  Can be a numpy array with shape (3, ) or with shape
(N, 3).</div>
</div>
</dd>
</dl>
<p>The return value has the same shape as the argument. This function is
the inverse of to_cartesian.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.unit_cells.UnitCell.volume">
<tt class="descname">volume</tt><a class="headerlink" href="#molmod.unit_cells.UnitCell.volume" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The volume of the unit cell.</p>
<p>The actual definition of the volume depends on the number of active
directions:</p>
<ul class="simple">
<li>num_active == 0  &#8211;  always -1</li>
<li>num_active == 1  &#8211;  length of the cell vector</li>
<li>num_active == 2  &#8211;  surface of the parallelogram</li>
<li>num_active == 3  &#8211;  volume of the parallelepiped</li>
</ul>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molmod.transformations">
<span id="molmod-transformations-transformations-in-3d"></span><h2><a class="reference internal" href="#module-molmod.transformations" title="molmod.transformations"><tt class="xref py py-mod docutils literal"><span class="pre">molmod.transformations</span></tt></a> Transformations in 3D<a class="headerlink" href="#module-molmod.transformations" title="Permalink to this headline">¶</a></h2>
<p>In addition to Translation, Rotation and Complete classes, two utility
functions are provided: rotation_around_center and superpose. The latter is an
implementation of the Kabsch algorithm.</p>
<dl class="class">
<dt id="molmod.transformations.Translation">
<em class="property">class </em><tt class="descclassname">molmod.transformations.</tt><tt class="descname">Translation</tt><big>(</big><em>t</em><big>)</big><a class="headerlink" href="#molmod.transformations.Translation" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a translation in 3D</p>
<p>The attribute t contains the actual translation vector, which is a numpy
array with three elements.</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">t</span></tt>  &#8211;  translation vector, a list-like object with three
numbers</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.transformations.Translation.apply_to">
<tt class="descname">apply_to</tt><big>(</big><em>x</em>, <em>columns=False</em><big>)</big><a class="headerlink" href="#molmod.transformations.Translation.apply_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply this translation to the given object</p>
<p>The argument can be several sorts of objects:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (3, )</li>
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (N, 3)</li>
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (3, N), use <tt class="docutils literal"><span class="pre">columns=True</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Translation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Rotation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Complete</span></tt></li>
<li><tt class="docutils literal"><span class="pre">UnitCell</span></tt></li>
</ul>
<p>In case of arrays, the 3D vectors are translated. In case of trans-
formations, a new transformation is returned that consists of this
translation applied AFTER the given translation. In case of a unit
cell, the original object is returned.</p>
<p>This method is equivalent to <tt class="docutils literal"><span class="pre">self*x</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.transformations.Translation.compare">
<tt class="descname">compare</tt><big>(</big><em>other</em>, <em>t_threshold=0.001</em><big>)</big><a class="headerlink" href="#molmod.transformations.Translation.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two translations</p>
<p>The RMSD of the translation vectors is computed. The return value
is True when the RMSD is below the threshold, i.e. when the two
translations are almost identical.</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Translation.from_matrix">
<em class="property">classmethod </em><tt class="descname">from_matrix</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#molmod.transformations.Translation.from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a translation from a 4x4 matrix</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Translation.identity">
<em class="property">classmethod </em><tt class="descname">identity</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.transformations.Translation.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the identity transformation</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Translation.inv">
<tt class="descname">inv</tt><a class="headerlink" href="#molmod.transformations.Translation.inv" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The inverse translation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Translation.matrix">
<tt class="descname">matrix</tt><a class="headerlink" href="#molmod.transformations.Translation.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The 4x4 matrix representation of this translation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Translation.t">
<tt class="descname">t</tt><a class="headerlink" href="#molmod.transformations.Translation.t" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the translation vector.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have shape (3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.transformations.Rotation">
<em class="property">class </em><tt class="descclassname">molmod.transformations.</tt><tt class="descname">Rotation</tt><big>(</big><em>r</em><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a rotation in 3D about the origin</p>
<p>The attribute r contains the actual rotation matrix, which is a numpy
array with shape (3, 3).</p>
<dl class="docutils">
<dt>Argument:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">r</span></tt>  &#8211;  rotation matrix, a 3 by 3 orthonormal array-like object</div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="molmod.transformations.Rotation.apply_to">
<tt class="descname">apply_to</tt><big>(</big><em>x</em>, <em>columns=False</em><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation.apply_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply this rotation to the given object</p>
<p>The argument can be several sorts of objects:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (3, )</li>
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (N, 3)</li>
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (3, N), use <tt class="docutils literal"><span class="pre">columns=True</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Translation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Rotation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Complete</span></tt></li>
<li><tt class="docutils literal"><span class="pre">UnitCell</span></tt></li>
</ul>
<p>In case of arrays, the 3D vectors are rotated. In case of trans-
formations, a transformation is returned that consists of this
rotation applied AFTER the given translation. In case of a unit cell,
a unit cell with rotated cell vectors is returned.</p>
<p>This method is equivalent to <tt class="docutils literal"><span class="pre">self*x</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="molmod.transformations.Rotation.compare">
<tt class="descname">compare</tt><big>(</big><em>other</em>, <em>r_threshold=0.001</em><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two rotations</p>
<p>The RMSD of the rotation matrices is computed. The return value
is True when the RMSD is below the threshold, i.e. when the two
rotations are almost identical.</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Rotation.from_matrix">
<em class="property">classmethod </em><tt class="descname">from_matrix</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation.from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a rotation from a 4x4 matrix</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Rotation.from_properties">
<em class="property">classmethod </em><tt class="descname">from_properties</tt><big>(</big><em>angle</em>, <em>axis</em>, <em>invert</em><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation.from_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a rotation based on the properties</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Rotation.identity">
<em class="property">classmethod </em><tt class="descname">identity</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the identity transformation</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Rotation.inv">
<tt class="descname">inv</tt><a class="headerlink" href="#molmod.transformations.Rotation.inv" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The inverse rotation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Rotation.matrix">
<tt class="descname">matrix</tt><a class="headerlink" href="#molmod.transformations.Rotation.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The 4x4 matrix representation of this rotation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Rotation.properties">
<tt class="descname">properties</tt><a class="headerlink" href="#molmod.transformations.Rotation.properties" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Rotation properties: angle, axis, invert.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Rotation.r">
<tt class="descname">r</tt><a class="headerlink" href="#molmod.transformations.Rotation.r" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the rotation matrix.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 2.</li>
<li>Must have shape (3, 3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
<li>Special conditions: the columns must orthogonal.</li>
</ul>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Rotation.random">
<em class="property">classmethod </em><tt class="descname">random</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.transformations.Rotation.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random rotation</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="molmod.transformations.Complete">
<em class="property">class </em><tt class="descclassname">molmod.transformations.</tt><tt class="descname">Complete</tt><big>(</big><em>r</em>, <em>t</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a rotation and translation in 3D</p>
<p>The attribute t contains the actual translation vector, which is a numpy
array with three elements. The attribute r contains the actual rotation
matrix, which is a numpy array with shape (3, 3).</p>
<p>Internally the translation part is always applied after the rotation
part.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">r</span></tt>  &#8211;  rotation matrix, a 3 by 3 orthonormal array-like object</div>
<div class="line"><tt class="docutils literal"><span class="pre">t</span></tt>  &#8211;  translation vector, a list-like object with three
numbers</div>
</div>
</dd>
</dl>
<dl class="classmethod">
<dt id="molmod.transformations.Complete.about_axis">
<em class="property">classmethod </em><tt class="descname">about_axis</tt><big>(</big><em>center</em>, <em>angle</em>, <em>axis</em>, <em>invert=False</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.about_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create transformation that represents a rotation about an axis</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">center</span></tt>  &#8211;  Point on the axis</div>
<div class="line"><tt class="docutils literal"><span class="pre">angle</span></tt>  &#8211;  Rotation angle</div>
<div class="line"><tt class="docutils literal"><span class="pre">axis</span></tt>  &#8211;  Rotation axis</div>
<div class="line"><tt class="docutils literal"><span class="pre">invert</span></tt>  &#8211;  When True, an inversion rotation is constructed
[default=False]</div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="molmod.transformations.Complete.apply_to">
<tt class="descname">apply_to</tt><big>(</big><em>x</em>, <em>columns=False</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.apply_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply this transformation to the given object</p>
<p>The argument can be several sorts of objects:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (3, )</li>
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (N, 3)</li>
<li><tt class="docutils literal"><span class="pre">numpy.array</span></tt> with shape (3, N), use <tt class="docutils literal"><span class="pre">columns=True</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Translation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Rotation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Complete</span></tt></li>
<li><tt class="docutils literal"><span class="pre">UnitCell</span></tt></li>
</ul>
<p>In case of arrays, the 3D vectors are transformed. In case of trans-
formations, a transformation is returned that consists of this
transformation applied AFTER the given translation. In case of a unit
cell, a unit cell with rotated cell vectors is returned. (The
translational part does not affect the unit cell.)</p>
<p>This method is equivalent to self*x.</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Complete.cast">
<em class="property">classmethod </em><tt class="descname">cast</tt><big>(</big><em>c</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.cast" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the first argument into a Complete object</p>
</dd></dl>

<dl class="method">
<dt id="molmod.transformations.Complete.compare">
<tt class="descname">compare</tt><big>(</big><em>other</em>, <em>t_threshold=0.001</em>, <em>r_threshold=0.001</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two transformations</p>
<p>The RMSD values of the rotation matrices and the translation vectors
are computed. The return value is True when the RMSD values are below
the thresholds, i.e. when the two transformations are almost
identical.</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Complete.from_matrix">
<em class="property">classmethod </em><tt class="descname">from_matrix</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a complete transformation from a 4x4 matrix</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Complete.from_properties">
<em class="property">classmethod </em><tt class="descname">from_properties</tt><big>(</big><em>angle</em>, <em>axis</em>, <em>invert</em>, <em>translation</em><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.from_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a transformation based on the properties</p>
</dd></dl>

<dl class="classmethod">
<dt id="molmod.transformations.Complete.identity">
<em class="property">classmethod </em><tt class="descname">identity</tt><big>(</big><big>)</big><a class="headerlink" href="#molmod.transformations.Complete.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the identity transformation</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Complete.inv">
<tt class="descname">inv</tt><a class="headerlink" href="#molmod.transformations.Complete.inv" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The inverse transformation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Complete.matrix">
<tt class="descname">matrix</tt><a class="headerlink" href="#molmod.transformations.Complete.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> The 4x4 matrix representation of this transformation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Complete.properties">
<tt class="descname">properties</tt><a class="headerlink" href="#molmod.transformations.Complete.properties" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Cached attribute:</em> Transformation properties: angle, axis, invert, translation.</p>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Complete.r">
<tt class="descname">r</tt><a class="headerlink" href="#molmod.transformations.Complete.r" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the rotation matrix.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 2.</li>
<li>Must have shape (3, 3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
<li>Special conditions: the columns must orthogonal.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="molmod.transformations.Complete.t">
<tt class="descname">t</tt><a class="headerlink" href="#molmod.transformations.Complete.t" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Read-only attribute:</em> the translation vector.</p>
<p>The attribute must satisfy the following conditions:</p>
<ul class="simple">
<li>May not be None.</li>
<li>Must be an instance of <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'numpy.ndarray'&gt;</span></tt></li>
<li>Must have dimension 1.</li>
<li>Must have shape (3).</li>
<li>Must have dtype <tt class="docutils literal"><span class="pre">&lt;type</span> <span class="pre">'float'&gt;</span></tt>.</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="molmod.transformations.superpose">
<tt class="descclassname">molmod.transformations.</tt><tt class="descname">superpose</tt><big>(</big><em>ras</em>, <em>rbs</em>, <em>weights=None</em><big>)</big><a class="headerlink" href="#molmod.transformations.superpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the transformation that minimizes the RMSD between the points ras and rbs</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">ras</span></tt>  &#8211;  a <tt class="docutils literal"><span class="pre">numpy.array</span></tt> with 3D coordinates of geometry A,
shape=(N,3)</div>
<div class="line"><tt class="docutils literal"><span class="pre">rbs</span></tt>  &#8211;  a <tt class="docutils literal"><span class="pre">numpy.array</span></tt> with 3D coordinates of geometry B,
shape=(N,3)</div>
</div>
</dd>
<dt>Optional arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">weights</span></tt>  &#8211;  a numpy array with fitting weights for each
coordinate, shape=(N,)</div>
</div>
</dd>
<dt>Return value:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">transformation</span></tt>  &#8211;  the transformation that brings geometry A into
overlap with geometry B</div>
</div>
</dd>
</dl>
<p>Each row in ras and rbs represents a 3D coordinate. Corresponding rows
contain the points that are brought into overlap by the fitting
procedure. The implementation is based on the Kabsch Algorithm:</p>
<p><a class="reference external" href="http://dx.doi.org/10.1107%2FS0567739476001873">http://dx.doi.org/10.1107%2FS0567739476001873</a></p>
</dd></dl>

<dl class="function">
<dt id="molmod.transformations.fit_rmsd">
<tt class="descclassname">molmod.transformations.</tt><tt class="descname">fit_rmsd</tt><big>(</big><em>ras</em>, <em>rbs</em>, <em>weights=None</em><big>)</big><a class="headerlink" href="#molmod.transformations.fit_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit geometry rbs onto ras, returns more info than superpose</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">ras</span></tt>  &#8211;  a numpy array with 3D coordinates of geometry A,
shape=(N,3)</div>
<div class="line"><tt class="docutils literal"><span class="pre">rbs</span></tt>  &#8211;  a numpy array with 3D coordinates of geometry B,
shape=(N,3)</div>
</div>
</dd>
<dt>Optional arguments:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">weights</span></tt>  &#8211;  a numpy array with fitting weights for each
coordinate, shape=(N,)</div>
</div>
</dd>
<dt>Return values:</dt>
<dd><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">transformation</span></tt>  &#8211;  the transformation that brings geometry A into
overlap with geometry B</div>
<div class="line"><tt class="docutils literal"><span class="pre">rbs_trans</span></tt>  &#8211;  the transformed coordinates of geometry B</div>
<div class="line"><tt class="docutils literal"><span class="pre">rmsd</span></tt>  &#8211;  the rmsd of the distances between corresponding atoms in
geometry A and B</div>
</div>
</dd>
</dl>
<p>This is a utility routine based on the function superpose. It just
computes rbs_trans and rmsd after calling superpose with the same
arguments</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basic classes</a><ul>
<li><a class="reference internal" href="#molmod-molecules-molecular-systems"><tt class="docutils literal"><span class="pre">molmod.molecules</span></tt> &#8211; Molecular systems</a></li>
<li><a class="reference internal" href="#module-molmod.graphs"><tt class="docutils literal"><span class="pre">molmod.graphs</span></tt> &#8211; Abstract graphs</a></li>
<li><a class="reference internal" href="#molmod-molecular-graphs-molecular-graphs"><tt class="docutils literal"><span class="pre">molmod.molecular_graphs</span></tt> &#8211; Molecular graphs</a></li>
<li><a class="reference internal" href="#module-molmod.unit_cells"><tt class="docutils literal"><span class="pre">molmod.unit_cells</span></tt> &#8211; Periodic boundary conditions</a></li>
<li><a class="reference internal" href="#module-molmod.transformations"><tt class="docutils literal"><span class="pre">molmod.transformations</span></tt> Transformations in 3D</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="const.html"
                        title="previous chapter">Units and constants</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="io.html"
                        title="next chapter">Input/output</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/reference/basic.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="io.html" title="Input/output"
             >next</a> |</li>
        <li class="right" >
          <a href="const.html" title="Units and constants"
             >previous</a> |</li>
        <li><a href="../index.html">MolMod 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Toon Verstraelen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>